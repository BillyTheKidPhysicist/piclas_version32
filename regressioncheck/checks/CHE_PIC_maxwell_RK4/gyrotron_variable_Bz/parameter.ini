! =============================================================================== !
! EQUATION (linearscalaradvection)
! =============================================================================== !
IniExactFunc    = 0

! =============================================================================== !
! DISCRETIZATION
! =============================================================================== !
N               = 1  ! Polynomial degree
NAnalyze        = 8 ! Number of analyze points

! =============================================================================== !
! MESH
! =============================================================================== !
MeshFile        = NGeo6_140GHz_TE28_8_mesh.h5
useCurveds      = F
! =============================================================================== !
! OUTPUT / VISUALIZATION
! =============================================================================== !
ProjectName      = TE28_8
Logging          = F
WriteErrorFiles  = F
printRandomSeeds = F
DoCalcErrorNorms = T
TrackingMethod   = refmapping

! =============================================================================== !
! CALCULATION
! =============================================================================== !
tend       = 3.00E-11
Analyze_dt = 1.0E-9
CFLscale   = 0.9     ! Scaling of theoretical CFL number
c_corr     = 1

! =============================================================================== !
! Load Balance
! =============================================================================== !
DoLoadBalance           = F
Load-DeviationThreshold = 9000
Particles-MPIWeight     = 0.01
!Particles-MPIWeight       = 0.7 ! old

! =============================================================================== !
! PARTICLES
! =============================================================================== !

!Particles-HaloEpsVelo     = 1e8
Part-SafetyFactor=2
!Part-DelayTime = 1e-10
TEScale=0.

Part-maxParticleNumber    = 150000 !2000 !50000
Part-nSpecies             = 1
Part-nBounds              = 3
Part-Boundary1-SourceName = BC_Inflow
Part-Boundary1-Condition  = open
Part-Boundary2-SourceName = BC_Outflow ! BC_Outflow
Part-Boundary2-Condition  = open
Part-Boundary3-SourceName = BC_Wall
Part-Boundary3-Condition  = reflective
PIC-Interpolation-Type    = particle_position
PIC-Deposition-Type       = cell_volweight
Part-FIBGMdeltas          = (/0.001,0.001,0.001/)
PIC-Depo-Periodic         = FALSE
PIC-shapefunction-radius  = 0.001
PIC-shapefunction-alpha   = 4
!Particles-HaloEpsVelo     = 124688338.75577
! =============================================================================== !
! Species1 - electrons
! =============================================================================== !
! soft exciation
PIC-curvedexternalField             = variable_Bz.csv
Part-Species1-Init1-RadiusICGyro          = 0.00014527351656! for variable magnetic field

  !PIC-externalField                   = (/0.,0.,0.,0.,0.,5.587/)
  !Part-Species1-RadiusICGyro          = 0.0001416824527
  !Part-Species1-ParticleEmission      = 274626E9 ! in particles per second 100%
  !Part-Species1-ParticleEmission       = 272581.6377E9 ! used from 10ns on forward
Part-Species1-Init1-ParticleEmission       = 272492.25E9 ! calculated from from 10ns to 13ns
  !Part-Species1-ParticleEmission       = E9 ! reduced because current is too large ! reduced from theoretical value
  !Part-Species1-ParticleEmission       = E9 ! reduced from t=1...10ns value 249866



! hard exciation
  !PIC-externalField                   = (/0.,0.,0.,0.,0.,5.537/)
  !Part-Species1-RadiusICGyro          = 0.00014296
  !Part-Species1-ParticleEmission      = 253510E9 ! in particles per second 92.31%

! gyrotron parameters

Part-Species1-ChargeIC              = -1.60217653E-19
Part-Species1-MassIC                = 9.1093826E-31
Part-Species1-MacroParticleFactor   = 1E6


Part-Species1-nInits = 1

Part-Species1-Init1-SpaceIC               = gyrotron_circle
Part-Species1-Init1-velocityDistribution  = gyrotron_circle
Part-Species1-Init1-initialParticleNumber = 0 !270455
Part-Species1-Init1-CuboidHeightIC        = 0.001
Part-Species1-Init1-ParticleEmissionType  = 1
Part-Species1-Init1-RadiusIC              = 0.0101
Part-Species1-Init1-Alpha                 = 1.3
Part-Species1-Init1-BasePointIC           =  (/0.0,0.0,0.00001/)
Part-Species1-Init1-NormalIC              = (/0.,0.,1./)
Part-Species1-Init1-VeloIC                = 120124575.25612
! =============================================================================== !
! Analysis
! =============================================================================== !
Part-AnalyzeStep  = 1
CalcKineticEnergy = T
CalcPartBalance   = T
CalcCharge               = T
CalcPotentialEnergy      = TRUE
CalcNumSpec              = T
Part-NumberOfRandomSeeds = 2
Particles-RandomSeed1    = 1180520427
Particles-RandomSeed2    = 1708457652
PIC-OutputSource = T ! HDF5 output of maxwell source terms
! =============================================================================== !
! Poynting Vector Integral
! =============================================================================== !

! long gyrotron
CalcPoyntingVecIntegral  = F
PoyntingVecInt-Planes=2
Plane-01-z-coord=0.000000   !entry (PML exit)
Plane-02-z-coord=0.003000   !entry (PML exit)


Plane-Tolerance          = 1e-5
! =============================================================================== !
! Recordpoints
! =============================================================================== !
!RP_OutputInterval        = 500 ! 28500 - c_corr = 6 bzw. 4700 - c_corr = 1 !
RP_SamplingOffset        = 15 ! only each x time step
RP_DefFile               = 140GHz_TE28_8_RPSet.h5
RP_inUse                 = F

! =============================================================================== !
! PML (perfectly matched layer)
! =============================================================================== !
DoPML                = F
PMLzeta0             = 70.0e9  ! damping constant in PML region, physical regions zeta=0
PMLzetaShape         = 1        ! shape function for damping constant (0=const, 1=linear, 2=sinus)
PMLspread            = 0        ! spread=1 dont spread=0
PMLwriteZeta         = 0        ! write zeta field=1,  dont write zeta field=0
  !xyzPhysicalMinMax    =(/-1.,1.,-1.,1.,0.000,0.0774/)
xyzPhysicalMinMax    =(/-1.,1.,-1.,1.,0.000,0.105400/)
